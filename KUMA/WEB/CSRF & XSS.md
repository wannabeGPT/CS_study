# CSRF & XSS

## CSRF (Cross Site Request Forgery)
* 웹 어플리케이션 취약점 중 하나로, `사용자가 자신의 의지와 무관하게 공격자가 의도한 행위(modify, delete, register 등)을 특정한 웹사이트에 request하도록 만드는 공격`
* 유저의 권한을 도용해 중요한 기능을 실행하도록 한다.
  * 해커가 사용자의 SNS 계정으로 광고성 글을 올리는 것

### 조건
* 사용자가 해커가 만든 피싱 사이트에 접속
* 위조 요청을 전송하는 서비스에 사용자가 로그인을 한 상황

### 대응기법
* 리퍼러(Refferer) 검증
  * 백엔드 측에서 Refferer 검증을 통해 승인된 도메인으로 요청시에만 처리하도록 한다.
* Security Token 사용
  * 사용자의 세션에 임의의 난수 값을 저장하고, 사용자의 요청시 해당 값을 포함하여 전송시킨다. 백엔드 단에서는 요청을 받을 때 세션에 저장된 토큰값과 요청 파라미터로 전달받는 토큰 값이 일치하는 지 검증 과정을 거치는 방법

## XSS (Cross Site Scription)
* 마찬가지로 웹 어플리케이션 취약점 중 하나로 관리자가 아닌 권한 없는 사용자가 웹사이트에 `스크립트를 삽입하는 공격`
* 스크립트를 삽입해서 이를 열람한 사용자의 쿠키가 해커에게 전달되며 이 탈취한 쿠키를 통해 세션 하이재킹 공격을 한다. `해커는 세션ID를 가진 쿠키로 사용자의 계정에 접근`한다.

### 종류
* 지속성
  * 지속적으로 피해를 입히는 유형
  * 악성 스크립트를 삽입하여 열람한 사용자의 쿠키를 탈취하거나 리다이렉션 시킨다.
  * 이 때 스크립트를 DB에 저장시켜 지속적으로 피해를 입힌다.
* 반사형
  * 사용자에게 입력 받은 값을 서버에서 되돌려 주는 곳에서 발생
  * 악성 스크립트와 함께 URL을 사용자에게 누르도록 유도
* DOM 기반
  * 악성 스크립트가 포함된 URL을 사용자가 요청하게 되면서 브라우저를 해석하는 단계에서 발생
  * 이 스크립트로 인해 클라이언트 측 코드가 원래 의도와 다르게 실행
  * 서버 측에서 탐지가 어렵다.

### 대응기법
* 입출력 값 검증
  * XSS Cheat Sheet에 대한 필터 목록을 만들어 모든 Cheat Sheet에 대한 대응을 가능하도록 사전에 대비한다.
* XSS 방어 라이브러리, 확장앱
  * Anti XSS 라이브러리를 사용한다. 서버단에 추가하며, 사용자들은 각자 브라우저에 확장앱을 설치하여 방어한다.
* 웹 방화벽
  * 웹 방화벽은 웹 공격에 특화된 것으로 다양한 Injection을 한꺼번에 방어할 수 있다.
* CORS, SOP 설정
  * CORS(Croos Origin Resouce Sharing), SOP(Same Origin Policy)를 통해 리소스의 Source를 제한하는 방법
  * 사전에 지정된 도메인이나 범위가 아니라면 리소스를 가져올 수 없게 제한